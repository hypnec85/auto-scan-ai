# 변경 이력 (Changelog)

이 프로젝트의 모든 주요 변경 사항은 이 파일에 기록됩니다.

이 형식은 [Keep a Changelog](https://keepachangelog.com/ko/1.0.0/)를 기반으로 하며, 이 프로젝트는 [Semantic Versioning](https://semver.org/spec/v2.0.0.html)을 따릅니다.

## [Unreleased]

### 추가 (Added)
- **일괄 CSV 업로드 기능**: 여러 개의 CSV 파일을 동시에 선택하여 업로드하고 데이터를 병합하는 기능 추가.
- **데이터 출처 추적**: 데이터프레임에 `_source` 컬럼을 추가하여 'csv'와 'manual'(수기 입력) 데이터를 구분.
- **전체 삭제 기능**: 모든 매물 데이터를 한 번에 삭제하는 "전체 차량 삭제" 버튼 및 확인 절차 추가.
- **삭제 이력 관리**: CSV 파일 재업로드 시 삭제된 항목이 부활하는 것을 방지하기 위한 삭제 이력(`deleted_csv_rows`) 관리 로직 추가.

### 수정 (Fixed)
- **초기화 기능 개선**: "초기화 (모든 데이터 삭제)" 버튼 클릭 시 업로드된 파일 목록과 삭제 이력까지 완벽하게 리셋되도록 수정.
- **UI 사용성 개선**:
    - 파일 업로더(`st.file_uploader`)를 동적 키(`uploader_key`)로 관리하여 초기화 시 파일 목록이 제거되도록 개선.
    - "매물 삭제하기" 섹션이 삭제 작업 중 접히지 않도록 `expander` 상태 제어 로직 개선.
- **데이터 보존 로직**: 파일 목록이 변경되거나 전체 삭제 시에도 수기 입력(`manual`) 데이터는 보존되도록 로직 변경 (단, 전체 초기화 시에는 삭제).

### 변경 (Changed)
- **데이터 구조**: `DEFAULT_COLUMNS` 및 `DEFAULT_DATA`에 `_source` 필드 추가.
- **삭제 로직**: 단순 인덱스 기반 삭제에서, CSV 데이터의 경우 고유 서명(Signature) 기반 삭제 이력 관리 방식으로 변경.

## [1.0.0] - 2025-12-02

### 추가됨 (Added)
- **UI**: 신규 매물 직접 추가 폼에 "특수용도이력" 선택 항목 추가.
- **UI**: 분석 결과 리스트(Tier 3 추천, Tier 1 경고)에 "특수용도이력" 컬럼 표시 추가.
- **UX**: "테스트용 데이터 로드" 버튼 클릭 시 데이터 손실 방지를 위한 확인(Confirm) 팝업 기능 추가.
- **AI 로직**: `datetime` 모듈을 도입하여 현재 날짜 기준 차량의 정확한 경과 개월 수 계산 로직 추가.
- **AI 로직**: LLM 프롬프트에 "특수용도이력" 및 "색상" 정보 필드 추가. 한국 시장의 색상 선호도(흰/검 > 은색 > 기타)와 렌트 이력 감가 요인을 분석에 반영하도록 개선.
- **AI 로직**: "1인소유" 정보를 프롬프트에 추가하여, 1인 소유 차량에 가산점을 부여하도록 평가 기준 개선.

### 변경됨 (Changed)
- **AI 프롬프트**: 엔지니어 페르소나가 반드시 정중한 경어체(하십시오체/해요체)를 사용하도록 지침 강화.
- **AI 프롬프트**: 단순히 주행거리만 보는 것이 아니라, '연식 대비 주행거리(혹사 여부)'를 판단하는 가성비 평가 로직 고도화.

### 수정됨 (Fixed)
- AI 리포트 생성 시 기준 날짜가 없어 차량의 감가 상태를 정확히 파악하지 못하던 문제 해결.